# Performance

이 프로젝트의 목표는 서버에서 대용량 트래픽을 효율적으로 처리하는 과정을 보여주는 것이다.
이를 위한 예제로 '티켓 구매 시스템'을 개발하면서 점진적으로 성능을 개선해 나간다.
최종 목표는 'scale out'으로 아래의 성능 요구사항을 충족하는 것이다.

-   5만개의 좌석이 존재하는 공연.
-   좌석도 시스템 사용자 50만 명.
-   사용자 한 명은 1분에 10번의 좌석을 선택/해제한다.
-   위의 조건을 수용하면 1분에 50만\*10회 만큼 서버에 업데이트가 이루어져야 한다.
-   이것은 1초에 8만 번의 업데이트가 발생하는 것이다.(500만/60sec = 84000/sec)
-   사용자가 좌석 선점 시 현재 상태가 업데이트 되게 한다면 1분에 500만 번의 읽기가 발생한다.
-   사용자가 좌석 선점 시 다른 사용자에게 바로 상태 업데이트를 한다면 50만/sec 읽기가 발생한다.

왜 이 정도의 수치가 나오는 지는 중요하지 않다. 중요한 것은 정말 많은 리퀘스트가 발생한다는 것이다.

## Getting Started

1. install docker
1. vscode에 remote - containers 설치
1. clone repository
1. https://github/hunjuly/per...
1. run task에서 run 선택
1. 디버깅은 attach 선택

## 좌석도 구조

이 프로젝트의 중요한 도메인은 좌석도이다. 사용자가 티켓을 구매하려면 좌석을 지정해야 한다. 공연 마다 다른 특성을 가지는 좌석 정보를 수용하기 위해서 좌석도의 구조를 다음과 같이 정의한다.

-   좌석도는 '블록' > '열' > '좌석'으로 구성된다.
-   좌석번호는 각 열에서 고유하며 순서는 불규칙하다.
-   노락색으로 표시된 '선점된 좌석'은 사용자가 구매를 위해서 선택한 좌석이다.
-   빨간색으로 표시된 좌석은 판매 완료된 좌석이다.

이 프로젝트의 목표가 성능임에도 불구하고 도메인을 비교적 복잡한 수준으로 정의했다.
이것은 이러한 정의가 향후 개발하게 될 캐쉬 알고리즘과 연관이 있기 때문에 지나치게 단순화 하지 않은 것이다.

정의에 따라서 아래 좌석도는 블록 A/B, 열 가/나/다/라, 다수의 좌석들로 구성되어있다.

<img src="./seatmap_structure.png"  height="300px" />

## 버전 1.0 요구사항

성능은 고려하지 않으며 최소한의 기능을 최대한 간단하게 작성한다.

### 기능

-   좌석도 생성/조회
-   전체좌석 상태 조회
-   좌석 선점/취소
-   좌석 구매/취소
